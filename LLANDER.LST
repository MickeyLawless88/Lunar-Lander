Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    1
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

        1  C ****************************************************************
        2  C *                  LUNAR LANDER SIMULATION                     *
        3  C *              ANSI FORTRAN 77 Implementation                  *
        4  C *          with Enhanced Character Graphics Display            *
        5  C *                                                              *
        6  C *             Mickey W. Lawless  Dec.21-2025                   *
        7  C *          Compiler: Lahey Personal FORTRAN 77                *
        8  C *                                                              *
        9  C ****************************************************************
       10  
       11        PROGRAM LUNARL
       12      
       13        IMPLICIT NONE
       14        INTEGER T, A, LANDST
       15        REAL H, V, V1, F, B, D
       16        
       17  C     Clear screen and display title
       18      
       19        CALL CLRSCR
       20        WRITE(*,100)
       21  100   FORMAT(/,
       22       >       '             LUNAR LANDING SIMULATION',/,
       23       >       '             ----- ------- ----------',/)
       24        WRITE(*,110)
       25  110   FORMAT(' DO YOU WANT INSTRUCTIONS',/,
       26       >       ' (Type 0 for NO): ')
       27        READ(*,*) A
       28        
       29        IF (A .NE. 0) THEN
       30           CALL INSTRS
       31        END IF
       32        
       33  C     Main game loop - restart point
       34  
       35  200   CONTINUE
       36        
       37        WRITE(*,210)
       38  210   FORMAT(//,' BEGINNING LANDING PROCEDURE.........',//,
       39       >       ' G O O D  L U C K ! ! !',///)
       40        
       41  C     Initialize variables
       42  
       43        T = 0
       44        H = 500.0
       45        V = 50.0
       46        F = 120.0
       47        
       48  C     Display header
       49  
       50        WRITE(*,220)
       51  220   FORMAT(' SEC   FEET   SPEED   FUEL',5X,
       52       >       'PLOT OF DISTANCE',/)
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    2
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

       53        
       54  C     Game loop - main landing sequence
       55  
       56  300   CONTINUE
       57        
       58  C     Display status with plot
       59  
       60        CALL DSPSTA(T, H, V, F)
       61        
       62  C     Check if fuel remains
       63  
       64        IF (F .GT. 0.0) THEN
       65           WRITE(*,310) 
       66  310      FORMAT(' ? ')
       67           READ(*,*) B
       68        ELSE
       69           B = 0.0
       70        END IF
       71        
       72  C     Limit fuel burn rate
       73  
       74        IF (B .LT. 0.0) B = 0.0
       75        IF (B .GT. 30.0) B = 30.0
       76        IF (B .GT. F) B = F
       77        
       78  C     Physics calculations
       79  
       80        V1 = V - B + 5.0
       81        F = F - B
       82        H = H - 0.5 * (V + V1)
       83        
       84  C     Check for touchdown
       85  
       86        IF (H .LE. 0.0) THEN
       87           GOTO 400
       88        END IF
       89        
       90        T = T + 1
       91        V = V1
       92        
       93  C     Check for out of fuel
       94  
       95        IF (F .LE. 0.0) THEN
       96           WRITE(*,320)
       97  320      FORMAT(/,' ***OUT OF FUEL***',/)
       98           GOTO 350
       99        END IF
      100        
      101        GOTO 300
      102        
      103  C     Out of fuel loop
      104  
      105  350   CONTINUELahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    3
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing


      106        CALL DSPSTA(T, H, V, F)
      107        B = 0.0
      108        V1 = V - B + 5.0
      109        F = F - B
      110        H = H - 0.5 * (V + V1)
      111        
      112        IF (H .LE. 0.0) THEN
      113           GOTO 400
      114        END IF
      115        
      116        T = T + 1
      117        V = V1
      118        GOTO 350
      119        
      120  C     Touchdown sequence
      121  
      122  400   CONTINUE
      123        
      124        WRITE(*,410)
      125  410   FORMAT(/,' ****CONTACT****',/)
      126        
      127  C     Calculate exact touchdown time and velocity
      128  
      129        H = H + 0.5 * (V + V1)
      130        
      131        IF (ABS(B - 5.0) .LT. 0.001) THEN
      132           D = H / V
      133        ELSE
      134           D = (-V + SQRT(V*V + H*(10.0 - 2.0*B))) / (5.0 - B)
      135        END IF
      136        
      137        V1 = V + (5.0 - B) * D
      138        
      139  C     Display landing statistics
      140  
      141        WRITE(*,420) REAL(T) + D, V1, F
      142  420   FORMAT('    TOUCHDOWN AT ',F6.2,' SECONDS.',/,
      143       >       '    LANDING VELOCITY = ',F6.1,' FT/SEC',/,
      144       >       '    ',F5.1,' UNITS OF FUEL REMAINING.',/)
      145        
      146  C     Draw landing scene based on outcome
      147  
      148        LANDST = 0
      149        IF (ABS(V1) .LT. 0.01) THEN
      150           LANDST = 1
      151        ELSE IF (ABS(V1) .LT. 2.0) THEN
      152           LANDST = 2
      153        ELSE
      154           LANDST = 3
      155        END IF
      156        
      157        CALL DRAWLD(LANDST)
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    4
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      158        
      159  C     Display landing evaluation
      160  
      161        IF (LANDST .EQ. 1) THEN
      162           WRITE(*,430)
      163  430      FORMAT(/,' CONGRATULATIONS!!!  A PERFECT LANDING!',/,
      164       >          ' YOUR LICENSE WILL BE RENEWED.........LATER.',/)
      165        ELSE IF (LANDST .EQ. 2) THEN
      166           WRITE(*,440)
      167  440      FORMAT(/,' WELL......THAT WAS OK.  BUT NOT SPECTACULAR...',/)
      168        ELSE
      169           WRITE(*,450)
      170  450      FORMAT(/,' ***** SORRY, BUT YOU BLEW IT KIDO!!!!!',/,
      171       >          ' THIS WAS OUR ONLY CHANCE TO MAKE CONTACT WITH',/,
      172       >          ' EXTRATERRESTRIAL BEINGS.  APPROPRIATE CONDOLENCES',/,
      173       >          ' MIGHT BE SENT TO YOUR NEXT OF KIN.',/)
      174        END IF
      175        
      176  C     Ask for another mission
      177  
      178        WRITE(*,460)
      179  460   FORMAT(/,' ANOTHER MISSION ANYONE',/,
      180       >       ' (Type 1 if YES): ')
      181        READ(*,*) A
      182        
      183        IF (A .EQ. 1) THEN
      184           CALL CLRSCR
      185           GOTO 200
      186        END IF
      187        
      188        WRITE(*,470)
      189  470   FORMAT(/,' CONTROL OUT.',//)
      190        
      191        STOP
      192        END

Storage Area Definitions
_______________________________________________________________________________________________________________________________Number  Name or Description     Segment Name          Hex Length

    0   Local Stack                                      0034
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    5
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>

A        INTEGER    VARIABLE    0  BP+FFF0    14s   27i   29u  181i  183u
Abs                 GENERIC                  131u  149u  151u
B        REAL       VARIABLE    0  BP+FFD8    15s   67i   69=   74u   74=   75u   75=   76u   76=   80u   81u  107=  108u  109u
                                             131u  134u  134u  137u
Clrscr              SUBROUTINE                19u  184u
D        REAL       VARIABLE    0  BP+FFD4    15s  132=  134=  137u  141u
Drawld              SUBROUTINE               157u
Dspsta              SUBROUTINE                60u  106u
F        REAL       VARIABLE    0  BP+FFDC    15s   46=   60r   64u   76u   76u   81=   81u   95u  106r  109=  109u  141o
H        REAL       VARIABLE    0  BP+FFE8    15s   44=   60r   82=   82u   86u  106r  110=  110u  112u  129=  129u  132u  134u
Instrs              SUBROUTINE                30u
Landst   INTEGER    VARIABLE    0  BP+FFEC    14s  148=  150=  152=  154=  157r  161u  165u
Lunarl              PROGRAM                   11s
Real     REAL       INTRINSIC                141u
Sqrt                GENERIC                  134u
T        INTEGER    VARIABLE    0  BP+FFF4    14s   43=   60r   90=   90u  106r  116=  116u  141u
V        REAL       VARIABLE    0  BP+FFE4    15s   45=   60r   80u   82u   91=  106r  108u  110u  117=  129u  132u  134u  134u
                                             134u  137u
V1       REAL       VARIABLE    0  BP+FFE0    15s   80=   82u   91u  108=  110u  117u  129u  137=  141o  149u  151u
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    6
PROGRAM LUNARL     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Label Cross-Reference Listing - Reference types:
 a-ASSIGN; d-DO Label; @-FORMAT Statement; f-FORMAT Usage; g-GOTO; i-IF; s-Specified; r-Argument
_______________________________________________________________________________________________________________________________Label        Line (I include file)<reference type - see above>

00100         20f   23@
00110         24f   26@
00200         35s  185g
00210         37f   39@
00220         50f   52@
00300         56s  101g
00310         65f   66@
00320         96f   97@
00350         98g  105s  118g
00400         87g  113g  122s
00410        124f  125@
00420        141f  144@
00430        162f  164@
00440        166f  167@
00450        169f  173@
00460        178f  180@
00470        188f  189@
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    7
SUBROUTINE INSTRS     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      193        
      194        
      195  C     ****************************************************************
      196  C     *                    SUBROUTINE INSTRS                         *
      197  C     *              Display game instructions                       *
      198  C     ****************************************************************
      199  
      200        SUBROUTINE INSTRS
      201  
      202        IMPLICIT NONE
      203        CHARACTER*1 CH
      204        
      205        WRITE(*,100)
      206  100   FORMAT(//,
      207       >       ' YOU ARE LANDING ON THE MOON AND HAVE TAKEN OVER MANUAL',
      208       >       /,
      209       >       ' CONTROL 500 FEET ABOVE A GOOD LANDING SPOT. YOU HAVE A',
      210       >       /,
      211       >       ' DOWNWARD VELOCITY OF 50 FT/SEC.  120 UNITS OF FUEL ',
      212       >       'REMAIN.',//,
      213       >       ' HERE ARE THE RULES THAT GOVERN YOUR SPACE VEHICLE:',/,
      214       >       ' (1) AFTER EACH SECOND, THE HEIGHT, VELOCITY, AND ',
      215       >       'REMAINING',/,
      216       >       '     FUEL WILL BE REPORTED.',/,
      217       >       ' (2) AFTER THE REPORT, A "?" WILL BE TYPED.  ENTER THE',
      218       >       /,
      219       >       '     NUMBER OF UNITS OF FUEL YOU WISH TO BURN DURING THE'
      220       >       ,/,
      221       >       '     NEXT SECOND.  EACH UNIT OF FUEL WILL SLOW YOUR ',
      222       >       'DESCENT',/,
      223       >       ' (3) THE MAXIMUM THRUST OF YOUR ENGINE IS 30 FT/SEC/SEC ',
      224       >       'OR',/,
      225       >       '     30 UNITS OF FUEL PER SECOND',/,
      226       >       ' (4) WHEN YOU CONTACT THE LUNAR SURFACE, YOUR DESCENT ',
      227       >       'ENGINE',/,
      228       >       '     WILL AUTOMATICALLY SHUT OFF AND YOU WILL BE GIVEN A'
      229       >       ,/,
      230       >       '     REPORT OF YOUR LANDING SPEED AND REMAINING FUEL',/,
      231       >       ' (5) IF YOU RUN OUT OF FUEL, THE "?" WILL NO LONGER ',
      232       >       'APPEAR',/,
      233       >       '     BUT YOUR SECOND BY SECOND REPORT WILL CONTINUE ',
      234       >       'UNTIL',/,
      235       >       '     YOU CONTACT LUNAR SURFACE.',//,
      236       >       ' HIT <RETURN> TO CONTINUE...')
      237        
      238        READ(*,'(A)') CH
      239        
      240        RETURN
      241        END
WARNING - CHARACTER*1 VARIABLE (CH) assigned a value, never used, line 238.
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    8
SUBROUTINE INSTRS     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Storage Area Definitions
_______________________________________________________________________________________________________________________________Number  Name or Description     Segment Name          Hex Length

    0   Local Stack                                      0011
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page    9
SUBROUTINE INSTRS     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>

Ch       CHAR*1     VARIABLE    0  BP+FFF7   203s  238i
Instrs              SUBROUTINE               200s
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   10
SUBROUTINE INSTRS     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Label Cross-Reference Listing - Reference types:
 a-ASSIGN; d-DO Label; @-FORMAT Statement; f-FORMAT Usage; g-GOTO; i-IF; s-Specified; r-Argument
_______________________________________________________________________________________________________________________________Label        Line (I include file)<reference type - see above>

00100        205f  236@
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   11
SUBROUTINE DSPSTA     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      242        
      243        
      244  C     ****************************************************************
      245  C     *                    SUBROUTINE DSPSTA                         *
      246  C     *       Display status with distance plot indicator            *
      247  C     ****************************************************************
      248        
      249        SUBROUTINE DSPSTA(T, H, V, F)
      250        
      251        IMPLICIT NONE
      252        INTEGER T, PLTPOS, I
      253        REAL H, V, F
      254        CHARACTER*80 LINE
      255        
      256  C     Calculate plot position (29 to 80)
      257        
      258        PLTPOS = INT(H / 12.0) + 29
      259        IF (PLTPOS .GT. 80) PLTPOS = 80
      260        IF (PLTPOS .LT. 29) PLTPOS = 29
      261        
      262  C     Build output line with plot indicator
      263        
      264        WRITE(LINE,100) T, H, V, F
      265  100   FORMAT(I3,F8.0,F8.0,F8.0,'     I')
      266        
      267  C     Add spaces and asterisk for plot
      268        
      269        DO 200 I = 29, PLTPOS-1
      270           LINE(I:I) = ' '
      271  200   CONTINUE
      272        
      273        IF (PLTPOS .LE. 80) THEN
      274           LINE(PLTPOS:PLTPOS) = '*'
      275           WRITE(*,'(A)') LINE(1:PLTPOS)
      276        ELSE
      277           WRITE(*,'(A)') LINE(1:29)
      278        END IF
      279        
      280        RETURN
      281        
      282        END

Storage Area Definitions
_______________________________________________________________________________________________________________________________Number  Name or Description     Segment Name          Hex Length

    0   Local Stack                                      006C

Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   12
SUBROUTINE DSPSTA     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>

Dspsta              SUBROUTINE               249s
F        REAL       VARIABLE                 249r  253s  264o
H        REAL       VARIABLE                 249r  253s  258u  264o
I        INTEGER    VARIABLE    0  BP+FFF0   252s  269d  270u  270u
Int      INTEGER    INTRINSIC                258u
Line     CHAR*80    VARIABLE    0  BP+FFA0   254s  264u  270=  274=  275u  277u
Pltpos   INTEGER    VARIABLE    0  BP+FFF4   252s  258=  259u  259=  260u  260=  269u  273u  274u  274u  275u
T        INTEGER    VARIABLE                 249r  252s  264o
V        REAL       VARIABLE                 249r  253s  264o
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   13
SUBROUTINE DSPSTA     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Label Cross-Reference Listing - Reference types:
 a-ASSIGN; d-DO Label; @-FORMAT Statement; f-FORMAT Usage; g-GOTO; i-IF; s-Specified; r-Argument
_______________________________________________________________________________________________________________________________Label        Line (I include file)<reference type - see above>

00100        264f  265@
00200        269d  271s
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   14
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      283        
      284        
      285  C     ****************************************************************
      286  C     *                    SUBROUTINE DRAWLD                         *
      287  C     *    Draw ultra-enhanced lunar lander scene with animation     *
      288  C     ****************************************************************
      289        
      290        SUBROUTINE DRAWLD(STATUS)
      291        
      292        IMPLICIT NONE
      293        INTEGER STATUS, I, J, ROW, COL
      294        CHARACTER*1 SCREEN(40,80)
      295        
      296  C     Initialize screen with spaces
      297        
      298        DO 100 I = 1, 40
      299           DO 110 J = 1, 80
      300              SCREEN(I,J) = ' '
      301  110      CONTINUE
      302  100   CONTINUE
      303        
      304  C     Draw detailed starfield with constellations
      305        
      306        SCREEN(2,5) = '*'
      307        SCREEN(2,6) = '-'
      308        SCREEN(2,7) = '*'
      309        SCREEN(3,15) = '.'
      310        SCREEN(3,16) = ':'
      311        SCREEN(3,17) = '.'
      312        SCREEN(1,25) = '*'
      313        SCREEN(2,26) = '|'
      314        SCREEN(3,25) = '*'
      315        SCREEN(4,35) = '.'
      316        SCREEN(2,50) = '*'
      317        SCREEN(3,51) = '*'
      318        SCREEN(4,50) = '*'
      319        SCREEN(5,55) = '.'
      320        SCREEN(3,8) = '.'
      321        SCREEN(1,42) = '*'
      322        SCREEN(4,60) = '.'
      323        SCREEN(2,68) = '*'
      324        SCREEN(5,12) = '.'
      325        SCREEN(3,48) = '*'
      326        SCREEN(1,65) = '.'
      327        SCREEN(4,20) = '*'
      328        SCREEN(5,38) = '.'
      329        SCREEN(1,72) = '*'
      330        SCREEN(2,33) = '.'
      331        SCREEN(4,76) = '*'
      332        SCREEN(3,28) = '.'
      333        SCREEN(5,70) = '.'
      334        SCREEN(1,10) = '*'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   15
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      335        SCREEN(4,45) = '.'
      336        
      337  C     Draw Earth in distance with more detail
      338        
      339        SCREEN(7,8) = '.'
      340        SCREEN(7,9) = '-'
      341        SCREEN(7,10) = '~'
      342        SCREEN(7,11) = '-'
      343        SCREEN(7,12) = '.'
      344        SCREEN(8,7) = '/'
      345        SCREEN(8,8) = '~'
      346        SCREEN(8,9) = ' '
      347        SCREEN(8,10) = 'o'
      348        SCREEN(8,11) = ' '
      349        SCREEN(8,12) = '~'
      350        SCREEN(8,13) = CHAR(92)
      351        SCREEN(9,7) = '|'
      352        SCREEN(9,8) = ' '
      353        SCREEN(9,9) = '~'
      354        SCREEN(9,10) = ' '
      355        SCREEN(9,11) = '~'
      356        SCREEN(9,12) = ' '
      357        SCREEN(9,13) = '|'
      358        SCREEN(10,7) = CHAR(92)
      359        SCREEN(10,8) = '~'
      360        SCREEN(10,9) = ' '
      361        SCREEN(10,10) = ' '
      362        SCREEN(10,11) = ' '
      363        SCREEN(10,12) = '~'
      364        SCREEN(10,13) = '/'
      365        SCREEN(11,8) = '.'
      366        SCREEN(11,9) = '-'
      367        SCREEN(11,10) = '~'
      368        SCREEN(11,11) = '-'
      369        SCREEN(11,12) = '.'
      370        
      371  C     Draw moon in background
      372        
      373        SCREEN(6,70) = '('
      374        SCREEN(6,71) = ' '
      375        SCREEN(6,72) = ')'
      376        SCREEN(7,69) = '/'
      377        SCREEN(7,70) = ' '
      378        SCREEN(7,71) = 'o'
      379        SCREEN(7,72) = ' '
      380        SCREEN(7,73) = CHAR(92)
      381        SCREEN(8,69) = '|'
      382        SCREEN(8,70) = ' '
      383        SCREEN(8,71) = ' '
      384        SCREEN(8,72) = ' '
      385        SCREEN(8,73) = '|'
      386        SCREEN(9,69) = CHAR(92)
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   16
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      387        SCREEN(9,70) = ' '
      388        SCREEN(9,71) = ' '
      389        SCREEN(9,72) = ' '
      390        SCREEN(9,73) = '/'
      391        SCREEN(10,70) = '('
      392        SCREEN(10,71) = '_'
      393        SCREEN(10,72) = ')'
      394        
      395  C     Draw distant mountains/craters on horizon
      396        
      397        SCREEN(30,10) = '/'
      398        SCREEN(30,11) = CHAR(92)
      399        SCREEN(29,11) = '/'
      400        SCREEN(29,12) = CHAR(92)
      401        SCREEN(30,25) = '/'
      402        SCREEN(29,25) = '/'
      403        SCREEN(29,26) = CHAR(92)
      404        SCREEN(30,26) = CHAR(92)
      405        SCREEN(30,52) = '/'
      406        SCREEN(29,52) = '/'
      407        SCREEN(29,53) = CHAR(92)
      408        SCREEN(30,53) = CHAR(92)
      409        SCREEN(30,68) = '/'
      410        SCREEN(30,69) = CHAR(92)
      411        
      412  C     Draw detailed lunar surface
      413        
      414        DO 200 J = 1, 80
      415           SCREEN(34,J) = '='
      416           SCREEN(35,J) = '#'
      417           SCREEN(36,J) = '#'
      418           SCREEN(37,J) = 'X'
      419           SCREEN(38,J) = 'X'
      420           SCREEN(39,J) = 'X'
      421           SCREEN(40,J) = 'X'
      422  200   CONTINUE
      423        
      424  C     Add detailed craters with shadows
      425        
      426        SCREEN(34,12) = 'o'
      427        SCREEN(33,11) = '/'
      428        SCREEN(33,12) = 'U'
      429        SCREEN(33,13) = CHAR(92)
      430        SCREEN(32,12) = '^'
      431        
      432        SCREEN(34,22) = 'O'
      433        SCREEN(33,20) = '/'
      434        SCREEN(33,21) = ' '
      435        SCREEN(33,22) = 'U'
      436        SCREEN(33,23) = ' '
      437        SCREEN(33,24) = CHAR(92)
      438        SCREEN(32,21) = '/'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   17
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      439        SCREEN(32,22) = '^'
      440        SCREEN(32,23) = CHAR(92)
      441        
      442        SCREEN(34,48) = 'O'
      443        SCREEN(33,46) = '/'
      444        SCREEN(33,47) = ' '
      445        SCREEN(33,48) = 'U'
      446        SCREEN(33,49) = ' '
      447        SCREEN(33,50) = CHAR(92)
      448        SCREEN(32,47) = '/'
      449        SCREEN(32,48) = '^'
      450        SCREEN(32,49) = CHAR(92)
      451        
      452        SCREEN(34,65) = 'o'
      453        SCREEN(33,65) = '^'
      454        
      455  C     Add rocks and boulders
      456        
      457        SCREEN(33,28) = '^'
      458        SCREEN(33,29) = '^'
      459        SCREEN(33,30) = '^'
      460        SCREEN(34,29) = 'o'
      461        
      462        SCREEN(33,58) = '^'
      463        SCREEN(33,59) = '^'
      464        SCREEN(34,58) = 'o'
      465        
      466        SCREEN(33,72) = '^'
      467        SCREEN(33,73) = '^'
      468        SCREEN(33,74) = '^'
      469        
      470        IF (STATUS .EQ. 1) THEN
      471  
      472  C        Perfect landing - highly detailed intact lander
      473  
      474           ROW = 23
      475           COL = 38
      476  
      477  C        Radio antenna with signal
      478  
      479           SCREEN(ROW-5,COL+2) = '.'
      480           SCREEN(ROW-4,COL+1) = '.'
      481           SCREEN(ROW-4,COL+2) = '|'
      482           SCREEN(ROW-4,COL+3) = '.'
      483           SCREEN(ROW-3,COL+2) = '|'
      484           SCREEN(ROW-2,COL+2) = '|'
      485           SCREEN(ROW-1,COL+2) = '|'
      486  
      487  C        Docking port
      488  
      489           SCREEN(ROW,COL+1) = '('
      490           SCREEN(ROW,COL+2) = 'o'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   18
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      491           SCREEN(ROW,COL+3) = ')'
      492  
      493  C        Command module top
      494  
      495           SCREEN(ROW+1,COL) = '/'
      496           SCREEN(ROW+1,COL+1) = '='
      497           SCREEN(ROW+1,COL+2) = '='
      498           SCREEN(ROW+1,COL+3) = '='
      499           SCREEN(ROW+1,COL+4) = CHAR(92)
      500  
      501  C        Window
      502  
      503           SCREEN(ROW+2,COL) = '|'
      504           SCREEN(ROW+2,COL+1) = '['
      505           SCREEN(ROW+2,COL+2) = 'o'
      506           SCREEN(ROW+2,COL+3) = ']'
      507           SCREEN(ROW+2,COL+4) = '|'
      508  
      509  C        USA marking with flag
      510  
      511           SCREEN(ROW+3,COL) = '|'
      512           SCREEN(ROW+3,COL+1) = 'U'
      513           SCREEN(ROW+3,COL+2) = 'S'
      514           SCREEN(ROW+3,COL+3) = 'A'
      515           SCREEN(ROW+3,COL+4) = '|'
      516  
      517  C        Lower module
      518  
      519           SCREEN(ROW+4,COL) = '|'
      520           SCREEN(ROW+4,COL+1) = '='
      521           SCREEN(ROW+4,COL+2) = '='
      522           SCREEN(ROW+4,COL+3) = '='
      523           SCREEN(ROW+4,COL+4) = '|'
      524  
      525  C        Descent stage
      526  
      527           SCREEN(ROW+5,COL-1) = '/'
      528           SCREEN(ROW+5,COL) = CHAR(92)
      529           SCREEN(ROW+5,COL+1) = '='
      530           SCREEN(ROW+5,COL+2) = 'H'
      531           SCREEN(ROW+5,COL+3) = '='
      532           SCREEN(ROW+5,COL+4) = '/'
      533           SCREEN(ROW+5,COL+5) = CHAR(92)
      534  
      535  C        Engine nozzle
      536  
      537           SCREEN(ROW+6,COL+1) = '('
      538           SCREEN(ROW+6,COL+2) = 'V'
      539           SCREEN(ROW+6,COL+3) = ')'
      540  
      541  C        Landing legs with shock absorbers
      542  
      543           SCREEN(ROW+7,COL-2) = '/'Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   19
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing


      544           SCREEN(ROW+7,COL-1) = '|'
      545           SCREEN(ROW+7,COL) = '|'
      546           SCREEN(ROW+7,COL+1) = ' '
      547           SCREEN(ROW+7,COL+2) = ' '
      548           SCREEN(ROW+7,COL+3) = ' '
      549           SCREEN(ROW+7,COL+4) = '|'
      550           SCREEN(ROW+7,COL+5) = '|'
      551           SCREEN(ROW+7,COL+6) = CHAR(92)
      552           SCREEN(ROW+8,COL-3) = '/'
      553           SCREEN(ROW+8,COL-2) = '='
      554           SCREEN(ROW+8,COL-1) = '='
      555           SCREEN(ROW+8,COL) = '='
      556           SCREEN(ROW+8,COL+4) = '='
      557           SCREEN(ROW+8,COL+5) = '='
      558           SCREEN(ROW+8,COL+6) = '='
      559           SCREEN(ROW+8,COL+7) = CHAR(92)
      560  
      561  C        Footpads with dust clouds
      562  
      563           SCREEN(ROW+9,COL-4) = '['
      564           SCREEN(ROW+9,COL-3) = '='
      565           SCREEN(ROW+9,COL-2) = '='
      566           SCREEN(ROW+9,COL-1) = ']'
      567           SCREEN(ROW+9,COL+5) = '['
      568           SCREEN(ROW+9,COL+6) = '='
      569           SCREEN(ROW+9,COL+7) = '='
      570           SCREEN(ROW+9,COL+8) = ']'
      571           SCREEN(ROW+10,COL-5) = '.'
      572           SCREEN(ROW+10,COL-4) = ':'
      573           SCREEN(ROW+10,COL-3) = '.'
      574           SCREEN(ROW+10,COL+6) = '.'
      575           SCREEN(ROW+10,COL+7) = ':'
      576           SCREEN(ROW+10,COL+8) = '.'
      577  
      578  C        Success banner
      579  
      580           SCREEN(ROW-8,COL-12) = '*'
      581           SCREEN(ROW-8,COL-11) = '*'
      582           SCREEN(ROW-8,COL-10) = '*'
      583           SCREEN(ROW-8,COL-9) = ' '
      584           SCREEN(ROW-8,COL-8) = 'P'
      585           SCREEN(ROW-8,COL-7) = 'E'
      586           SCREEN(ROW-8,COL-6) = 'R'
      587           SCREEN(ROW-8,COL-5) = 'F'
      588           SCREEN(ROW-8,COL-4) = 'E'
      589           SCREEN(ROW-8,COL-3) = 'C'
      590           SCREEN(ROW-8,COL-2) = 'T'
      591           SCREEN(ROW-8,COL-1) = '!'
      592           SCREEN(ROW-8,COL) = ' '
      593           SCREEN(ROW-8,COL+1) = '*'
      594           SCREEN(ROW-8,COL+2) = '*'
      595           SCREEN(ROW-8,COL+3) = '*'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   20
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      596  
      597  C        Flag on surface
      598  
      599           SCREEN(ROW+7,COL+10) = '|'
      600           SCREEN(ROW+8,COL+10) = '|'
      601           SCREEN(ROW+9,COL+10) = '|'
      602           SCREEN(ROW+7,COL+11) = '='
      603           SCREEN(ROW+7,COL+12) = '='
      604           SCREEN(ROW+8,COL+11) = '='
      605           SCREEN(ROW+8,COL+12) = '='
      606           
      607        ELSE IF (STATUS .EQ. 2) THEN
      608  
      609  C        OK landing - damaged but functional lander
      610  
      611           ROW = 25
      612           COL = 37
      613  
      614  C        Bent antenna
      615  
      616           SCREEN(ROW-4,COL+2) = '.'
      617           SCREEN(ROW-3,COL+2) = '/'
      618           SCREEN(ROW-2,COL+3) = '/'
      619           SCREEN(ROW-1,COL+3) = '|'
      620  
      621  C        Cracked docking port
      622  
      623           SCREEN(ROW,COL+1) = '('
      624           SCREEN(ROW,COL+2) = 'x'
      625           SCREEN(ROW,COL+3) = ')'
      626  
      627  C        Tilted command module
      628  
      629           SCREEN(ROW+1,COL+1) = '/'
      630           SCREEN(ROW+1,COL+2) = '='
      631           SCREEN(ROW+1,COL+3) = '='
      632           SCREEN(ROW+1,COL+4) = CHAR(92)
      633  
      634  C        Cracked window
      635  
      636           SCREEN(ROW+2,COL) = '/'
      637           SCREEN(ROW+2,COL+1) = '['
      638           SCREEN(ROW+2,COL+2) = '*'
      639           SCREEN(ROW+2,COL+3) = ']'
      640           SCREEN(ROW+2,COL+4) = '|'
      641  
      642  C        USA marking
      643  
      644           SCREEN(ROW+3,COL) = '|'
      645           SCREEN(ROW+3,COL+1) = 'U'
      646           SCREEN(ROW+3,COL+2) = 'S'
      647           SCREEN(ROW+3,COL+3) = 'A'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   21
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      648           SCREEN(ROW+3,COL+4) = '|'
      649  
      650  C        Damaged descent stage
      651  
      652           SCREEN(ROW+4,COL) = CHAR(92)
      653           SCREEN(ROW+4,COL+1) = '='
      654           SCREEN(ROW+4,COL+2) = '~'
      655           SCREEN(ROW+4,COL+3) = '='
      656           SCREEN(ROW+4,COL+4) = '/'
      657  
      658  C        Bent engine
      659  
      660           SCREEN(ROW+5,COL+1) = '('
      661           SCREEN(ROW+5,COL+2) = '/'
      662           SCREEN(ROW+5,COL+3) = ')'
      663  
      664  C        Broken legs
      665  
      666           SCREEN(ROW+6,COL-1) = '/'
      667           SCREEN(ROW+6,COL) = '|'
      668           SCREEN(ROW+6,COL+1) = '~'
      669           SCREEN(ROW+6,COL+3) = '|'
      670           SCREEN(ROW+6,COL+4) = CHAR(92)
      671           SCREEN(ROW+7,COL-2) = '/'
      672           SCREEN(ROW+7,COL-1) = '='
      673           SCREEN(ROW+7,COL) = '='
      674           SCREEN(ROW+7,COL+4) = '='
      675           SCREEN(ROW+7,COL+5) = '='
      676  
      677  C        Uneven footpads
      678  
      679           SCREEN(ROW+8,COL+4) = '['
      680           SCREEN(ROW+8,COL+5) = '='
      681           SCREEN(ROW+8,COL+6) = ']'
      682  
      683  C        Dust and small debris
      684  
      685           SCREEN(ROW+9,COL-3) = '.'
      686           SCREEN(ROW+9,COL+6) = '.'
      687           SCREEN(ROW+9,COL+7) = ':'
      688           SCREEN(ROW+7,COL-4) = '-'
      689           SCREEN(ROW+8,COL+8) = 'o'
      690           
      691        ELSE
      692  
      693  C        Crash landing - catastrophic destruction
      694  
      695           ROW = 26
      696           COL = 40
      697  
      698  C        Large explosion cloud
      699  
      700           SCREEN(ROW-10,COL-4) = '.'Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   22
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing


      701           SCREEN(ROW-10,COL-3) = '*'
      702           SCREEN(ROW-10,COL-2) = '.'
      703           SCREEN(ROW-10,COL-1) = '*'
      704           SCREEN(ROW-10,COL) = '.'
      705           SCREEN(ROW-10,COL+1) = '*'
      706           SCREEN(ROW-10,COL+2) = '.'
      707           SCREEN(ROW-10,COL+3) = '*'
      708           SCREEN(ROW-10,COL+4) = '.'
      709           SCREEN(ROW-9,COL-5) = '*'
      710           SCREEN(ROW-9,COL-4) = '.'
      711           SCREEN(ROW-9,COL-3) = ' '
      712           SCREEN(ROW-9,COL-2) = '*'
      713           SCREEN(ROW-9,COL-1) = ' '
      714           SCREEN(ROW-9,COL) = '.'
      715           SCREEN(ROW-9,COL+1) = ' '
      716           SCREEN(ROW-9,COL+2) = '*'
      717           SCREEN(ROW-9,COL+3) = ' '
      718           SCREEN(ROW-9,COL+4) = '.'
      719           SCREEN(ROW-9,COL+5) = '*'
      720           SCREEN(ROW-8,COL-6) = '.'
      721           SCREEN(ROW-8,COL-5) = '*'
      722           SCREEN(ROW-8,COL-4) = '.'
      723           SCREEN(ROW-8,COL-3) = ' '
      724           SCREEN(ROW-8,COL-2) = 'B'
      725           SCREEN(ROW-8,COL-1) = 'O'
      726           SCREEN(ROW-8,COL) = 'O'
      727           SCREEN(ROW-8,COL+1) = 'M'
      728           SCREEN(ROW-8,COL+2) = '!'
      729           SCREEN(ROW-8,COL+3) = ' '
      730           SCREEN(ROW-8,COL+4) = '.'
      731           SCREEN(ROW-8,COL+5) = '*'
      732           SCREEN(ROW-8,COL+6) = '.'
      733           SCREEN(ROW-7,COL-6) = '*'
      734           SCREEN(ROW-7,COL-5) = ' '
      735           SCREEN(ROW-7,COL-4) = '.'
      736           SCREEN(ROW-7,COL-3) = '*'
      737           SCREEN(ROW-7,COL-2) = ' '
      738           SCREEN(ROW-7,COL-1) = '.'
      739           SCREEN(ROW-7,COL) = ' '
      740           SCREEN(ROW-7,COL+1) = '*'
      741           SCREEN(ROW-7,COL+2) = ' '
      742           SCREEN(ROW-7,COL+3) = '.'
      743           SCREEN(ROW-7,COL+4) = '*'
      744           SCREEN(ROW-7,COL+5) = ' '
      745           SCREEN(ROW-7,COL+6) = '*'
      746           SCREEN(ROW-6,COL-5) = '.'
      747           SCREEN(ROW-6,COL-4) = '*'
      748           SCREEN(ROW-6,COL-3) = '.'
      749           SCREEN(ROW-6,COL-2) = ' '
      750           SCREEN(ROW-6,COL-1) = '*'
      751           SCREEN(ROW-6,COL) = '.'
      752           SCREEN(ROW-6,COL+1) = ' '
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   23
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      753           SCREEN(ROW-6,COL+2) = '*'
      754           SCREEN(ROW-6,COL+3) = '.'
      755           SCREEN(ROW-6,COL+4) = '*'
      756           SCREEN(ROW-6,COL+5) = '.'
      757  
      758  C        Fire and smoke
      759  
      760           SCREEN(ROW-5,COL-3) = '~'
      761           SCREEN(ROW-5,COL-2) = '}'
      762           SCREEN(ROW-5,COL-1) = '{'
      763           SCREEN(ROW-5,COL) = '~'
      764           SCREEN(ROW-5,COL+1) = '}'
      765           SCREEN(ROW-5,COL+2) = '{'
      766           SCREEN(ROW-5,COL+3) = '~'
      767           SCREEN(ROW-4,COL-2) = '}'
      768           SCREEN(ROW-4,COL-1) = '~'
      769           SCREEN(ROW-4,COL) = '{'
      770           SCREEN(ROW-4,COL+1) = '~'
      771           SCREEN(ROW-4,COL+2) = '}'
      772  
      773  C        Main wreckage (detailed)
      774  
      775           SCREEN(ROW-2,COL-3) = CHAR(92)
      776           SCREEN(ROW-2,COL-2) = '|'
      777           SCREEN(ROW-2,COL-1) = '/'
      778           SCREEN(ROW-2,COL) = '*'
      779           SCREEN(ROW-2,COL+1) = CHAR(92)
      780           SCREEN(ROW-2,COL+2) = '|'
      781           SCREEN(ROW-2,COL+3) = '/'
      782           SCREEN(ROW-1,COL-4) = '/'
      783           SCREEN(ROW-1,COL-3) = '-'
      784           SCREEN(ROW-1,COL-2) = 'X'
      785           SCREEN(ROW-1,COL-1) = 'X'
      786           SCREEN(ROW-1,COL) = 'X'
      787           SCREEN(ROW-1,COL+1) = 'X'
      788           SCREEN(ROW-1,COL+2) = 'X'
      789           SCREEN(ROW-1,COL+3) = '-'
      790           SCREEN(ROW-1,COL+4) = CHAR(92)
      791           SCREEN(ROW,COL-4) = '|'
      792           SCREEN(ROW,COL-3) = 'X'
      793           SCREEN(ROW,COL-2) = 'X'
      794           SCREEN(ROW,COL-1) = 'X'
      795           SCREEN(ROW,COL) = 'X'
      796           SCREEN(ROW,COL+1) = 'X'
      797           SCREEN(ROW,COL+2) = 'X'
      798           SCREEN(ROW,COL+3) = 'X'
      799           SCREEN(ROW,COL+4) = '|'
      800           SCREEN(ROW+1,COL-3) = CHAR(92)
      801           SCREEN(ROW+1,COL-2) = '-'
      802           SCREEN(ROW+1,COL-1) = 'X'
      803           SCREEN(ROW+1,COL) = '*'
      804           SCREEN(ROW+1,COL+1) = '|'
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   24
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      805           SCREEN(ROW+1,COL+2) = 'X'
      806           SCREEN(ROW+1,COL+3) = '-'
      807           SCREEN(ROW+1,COL+4) = '/'
      808           SCREEN(ROW+2,COL-2) = '/'
      809           SCREEN(ROW+2,COL-1) = '*'
      810           SCREEN(ROW+2,COL) = '|'
      811           SCREEN(ROW+2,COL+1) = CHAR(92)
      812           SCREEN(ROW+2,COL+2) = '*'
      813  
      814  C        Large debris field
      815  
      816           SCREEN(ROW-3,COL+7) = '/'
      817           SCREEN(ROW-3,COL+8) = '-'
      818           SCREEN(ROW-2,COL+8) = '|'
      819           SCREEN(ROW-2,COL-7) = CHAR(92)
      820           SCREEN(ROW-2,COL-8) = '-'
      821           SCREEN(ROW-1,COL-8) = '|'
      822           SCREEN(ROW-1,COL+9) = CHAR(92)
      823           SCREEN(ROW,COL-9) = '='
      824           SCREEN(ROW,COL-8) = '='
      825           SCREEN(ROW,COL+10) = '/'
      826           SCREEN(ROW+1,COL-10) = '|'
      827           SCREEN(ROW+1,COL+10) = '|'
      828           SCREEN(ROW+2,COL+9) = '-'
      829           SCREEN(ROW+2,COL+10) = '='
      830           SCREEN(ROW+2,COL-9) = '='
      831           SCREEN(ROW+2,COL-10) = '-'
      832  
      833  C        Scattered small debris
      834  
      835           SCREEN(ROW-4,COL+6) = 'o'
      836           SCREEN(ROW-3,COL-6) = '*'
      837           SCREEN(ROW-2,COL+11) = '.'
      838           SCREEN(ROW-1,COL-11) = '.'
      839           SCREEN(ROW,COL+12) = 'o'
      840           SCREEN(ROW,COL-12) = 'o'
      841           SCREEN(ROW+1,COL+11) = '*'
      842           SCREEN(ROW+1,COL-11) = '*'
      843           SCREEN(ROW+2,COL-12) = '.'
      844           SCREEN(ROW+3,COL-10) = ':'
      845           SCREEN(ROW+3,COL+11) = ':'
      846  
      847  C        Broken parts with labels
      848  
      849           SCREEN(ROW+3,COL-7) = '['
      850           SCREEN(ROW+3,COL-6) = 'U'
      851           SCREEN(ROW+3,COL-5) = 'S'
      852           SCREEN(ROW+3,COL-4) = ']'
      853           SCREEN(ROW+3,COL+5) = '['
      854           SCREEN(ROW+3,COL+6) = 'A'
      855           SCREEN(ROW+3,COL+7) = ']'
      856           SCREEN(ROW+4,COL-5) = '('
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   25
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      857           SCREEN(ROW+4,COL-4) = 'V'
      858           SCREEN(ROW+4,COL-3) = ')'
      859           SCREEN(ROW+4,COL+4) = '='
      860           SCREEN(ROW+4,COL+5) = '='
      861  
      862  C        Impact crater (large and detailed)
      863  
      864           SCREEN(ROW+3,COL-2) = '.'
      865           SCREEN(ROW+3,COL-1) = ':'
      866           SCREEN(ROW+3,COL) = ':'
      867           SCREEN(ROW+3,COL+1) = ':'
      868           SCREEN(ROW+3,COL+2) = '.'
      869           SCREEN(ROW+4,COL-3) = '('
      870           SCREEN(ROW+4,COL-2) = '-'
      871           SCREEN(ROW+4,COL-1) = '-'
      872           SCREEN(ROW+4,COL) = '-'
      873           SCREEN(ROW+4,COL+1) = '-'
      874           SCREEN(ROW+4,COL+2) = '-'
      875           SCREEN(ROW+4,COL+3) = ')'
      876           SCREEN(ROW+5,COL-4) = '('
      877           SCREEN(ROW+5,COL-3) = '~'
      878           SCREEN(ROW+5,COL-2) = '~'
      879           SCREEN(ROW+5,COL-1) = '~'
      880           SCREEN(ROW+5,COL) = '~'
      881           SCREEN(ROW+5,COL+1) = '~'
      882           SCREEN(ROW+5,COL+2) = '~'
      883           SCREEN(ROW+5,COL+3) = '~'
      884           SCREEN(ROW+5,COL+4) = ')'
      885           SCREEN(ROW+6,COL-3) = '('
      886           SCREEN(ROW+6,COL-2) = '='
      887           SCREEN(ROW+6,COL-1) = '='
      888           SCREEN(ROW+6,COL) = '='
      889           SCREEN(ROW+6,COL+1) = '='
      890           SCREEN(ROW+6,COL+2) = '='
      891           SCREEN(ROW+6,COL+3) = ')'
      892  
      893  C        Ejected rocks and lunar material
      894  
      895           SCREEN(ROW+5,COL-8) = 'o'
      896           SCREEN(ROW+5,COL+7) = 'o'
      897           SCREEN(ROW+6,COL-7) = '^'
      898           SCREEN(ROW+6,COL+8) = '^'
      899           SCREEN(ROW+7,COL-9) = '.'
      900           SCREEN(ROW+7,COL+9) = '.'
      901           
      902        END IF
      903        
      904  C     Display the screen
      905  
      906        DO 300 I = 1, 40
      907           WRITE(*,'(80A1)') (SCREEN(I,J), J=1,80)
      908  300   CONTINUE
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   26
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      909        
      910        RETURN
      911        
      912        END

Storage Area Definitions
_______________________________________________________________________________________________________________________________Number  Name or Description     Segment Name          Hex Length

    0   Local Stack                                      0E10
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   27
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>

Char     CHAR       INTRINSIC                350u  358u  380u  386u  398u  400u  403u  404u  407u  408u  410u  429u  437u  440u
                                             447u  450u  499u  528u  533u  551u  559u  632u  652u  670u  775u  779u  790u  800u
                                             811u  819u  822u
Col      INTEGER    VARIABLE    0  BP+FFE8   293s  475=  479u  480u  481u  482u  483u  484u  485u  489u  490u  491u  495u  496u
                                             497u  498u  499u  503u  504u  505u  506u  507u  511u  512u  513u  514u  515u  519u
                                             520u  521u  522u  523u  527u  528u  529u  530u  531u  532u  533u  537u  538u  539u
                                             543u  544u  545u  546u  547u  548u  549u  550u  551u  552u  553u  554u  555u  556u
                                             557u  558u  559u  563u  564u  565u  566u  567u  568u  569u  570u  571u  572u  573u
                                             574u  575u  576u  580u  581u  582u  583u  584u  585u  586u  587u  588u  589u  590u
                                             591u  592u  593u  594u  595u  599u  600u  601u  602u  603u  604u  605u  612=  616u
                                             617u  618u  619u  623u  624u  625u  629u  630u  631u  632u  636u  637u  638u  639u
                                             640u  644u  645u  646u  647u  648u  652u  653u  654u  655u  656u  660u  661u  662u
                                             666u  667u  668u  669u  670u  671u  672u  673u  674u  675u  679u  680u  681u  685u
                                             686u  687u  688u  689u  696=  700u  701u  702u  703u  704u  705u  706u  707u  708u
                                             709u  710u  711u  712u  713u  714u  715u  716u  717u  718u  719u  720u  721u  722u
                                             723u  724u  725u  726u  727u  728u  729u  730u  731u  732u  733u  734u  735u  736u
                                             737u  738u  739u  740u  741u  742u  743u  744u  745u  746u  747u  748u  749u  750u
                                             751u  752u  753u  754u  755u  756u  760u  761u  762u  763u  764u  765u  766u  767u
                                             768u  769u  770u  771u  775u  776u  777u  778u  779u  780u  781u  782u  783u  784u
                                             785u  786u  787u  788u  789u  790u  791u  792u  793u  794u  795u  796u  797u  798u
                                             799u  800u  801u  802u  803u  804u  805u  806u  807u  808u  809u  810u  811u  812u
                                             816u  817u  818u  819u  820u  821u  822u  823u  824u  825u  826u  827u  828u  829u
                                             830u  831u  835u  836u  837u  838u  839u  840u  841u  842u  843u  844u  845u  849u
                                             850u  851u  852u  853u  854u  855u  856u  857u  858u  859u  860u  864u  865u  866u
                                             867u  868u  869u  870u  871u  872u  873u  874u  875u  876u  877u  878u  879u  880u
                                             881u  882u  883u  884u  885u  886u  887u  888u  889u  890u  891u  895u  896u  897u
                                             898u  899u  900u
Drawld              SUBROUTINE               290s
I        INTEGER    VARIABLE    0  BP+FFF4   293s  298d  300u  906d  907u
J        INTEGER    VARIABLE    0  BP+FFF0   293s  299d  300u  414d  415u  416u  417u  418u  419u  420u  421u  907d  907u
Row      INTEGER    VARIABLE    0  BP+FFEC   293s  474=  479u  480u  481u  482u  483u  484u  485u  489u  490u  491u  495u  496u
                                             497u  498u  499u  503u  504u  505u  506u  507u  511u  512u  513u  514u  515u  519u
                                             520u  521u  522u  523u  527u  528u  529u  530u  531u  532u  533u  537u  538u  539u
                                             543u  544u  545u  546u  547u  548u  549u  550u  551u  552u  553u  554u  555u  556u
                                             557u  558u  559u  563u  564u  565u  566u  567u  568u  569u  570u  571u  572u  573u
                                             574u  575u  576u  580u  581u  582u  583u  584u  585u  586u  587u  588u  589u  590u
                                             591u  592u  593u  594u  595u  599u  600u  601u  602u  603u  604u  605u  611=  616u
                                             617u  618u  619u  623u  624u  625u  629u  630u  631u  632u  636u  637u  638u  639u
                                             640u  644u  645u  646u  647u  648u  652u  653u  654u  655u  656u  660u  661u  662u
                                             666u  667u  668u  669u  670u  671u  672u  673u  674u  675u  679u  680u  681u  685u
                                             686u  687u  688u  689u  695=  700u  701u  702u  703u  704u  705u  706u  707u  708u
                                             709u  710u  711u  712u  713u  714u  715u  716u  717u  718u  719u  720u  721u  722u
                                             723u  724u  725u  726u  727u  728u  729u  730u  731u  732u  733u  734u  735u  736u
                                             737u  738u  739u  740u  741u  742u  743u  744u  745u  746u  747u  748u  749u  750u
                                             751u  752u  753u  754u  755u  756u  760u  761u  762u  763u  764u  765u  766u  767u
                                             768u  769u  770u  771u  775u  776u  777u  778u  779u  780u  781u  782u  783u  784u
                                             785u  786u  787u  788u  789u  790u  791u  792u  793u  794u  795u  796u  797u  798u
                                             799u  800u  801u  802u  803u  804u  805u  806u  807u  808u  809u  810u  811u  812u
                                             816u  817u  818u  819u  820u  821u  822u  823u  824u  825u  826u  827u  828u  829u
                                             830u  831u  835u  836u  837u  838u  839u  840u  841u  842u  843u  844u  845u  849uLahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   28
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>


                                             850u  851u  852u  853u  854u  855u  856u  857u  858u  859u  860u  864u  865u  866u
                                             867u  868u  869u  870u  871u  872u  873u  874u  875u  876u  877u  878u  879u  880u
                                             881u  882u  883u  884u  885u  886u  887u  888u  889u  890u  891u  895u  896u  897u
                                             898u  899u  900u
Screen   CHAR*1     ARRAY       0  BP+F368   294s  300=  306=  307=  308=  309=  310=  311=  312=  313=  314=  315=  316=  317=
                                             318=  319=  320=  321=  322=  323=  324=  325=  326=  327=  328=  329=  330=  331=
                                             332=  333=  334=  335=  339=  340=  341=  342=  343=  344=  345=  346=  347=  348=
                                             349=  350=  351=  352=  353=  354=  355=  356=  357=  358=  359=  360=  361=  362=
                                             363=  364=  365=  366=  367=  368=  369=  373=  374=  375=  376=  377=  378=  379=
                                             380=  381=  382=  383=  384=  385=  386=  387=  388=  389=  390=  391=  392=  393=
                                             397=  398=  399=  400=  401=  402=  403=  404=  405=  406=  407=  408=  409=  410=
                                             415=  416=  417=  418=  419=  420=  421=  426=  427=  428=  429=  430=  432=  433=
                                             434=  435=  436=  437=  438=  439=  440=  442=  443=  444=  445=  446=  447=  448=
                                             449=  450=  452=  453=  457=  458=  459=  460=  462=  463=  464=  466=  467=  468=
                                             479=  480=  481=  482=  483=  484=  485=  489=  490=  491=  495=  496=  497=  498=
                                             499=  503=  504=  505=  506=  507=  511=  512=  513=  514=  515=  519=  520=  521=
                                             522=  523=  527=  528=  529=  530=  531=  532=  533=  537=  538=  539=  543=  544=
                                             545=  546=  547=  548=  549=  550=  551=  552=  553=  554=  555=  556=  557=  558=
                                             559=  563=  564=  565=  566=  567=  568=  569=  570=  571=  572=  573=  574=  575=
                                             576=  580=  581=  582=  583=  584=  585=  586=  587=  588=  589=  590=  591=  592=
                                             593=  594=  595=  599=  600=  601=  602=  603=  604=  605=  616=  617=  618=  619=
                                             623=  624=  625=  629=  630=  631=  632=  636=  637=  638=  639=  640=  644=  645=
                                             646=  647=  648=  652=  653=  654=  655=  656=  660=  661=  662=  666=  667=  668=
                                             669=  670=  671=  672=  673=  674=  675=  679=  680=  681=  685=  686=  687=  688=
                                             689=  700=  701=  702=  703=  704=  705=  706=  707=  708=  709=  710=  711=  712=
                                             713=  714=  715=  716=  717=  718=  719=  720=  721=  722=  723=  724=  725=  726=
                                             727=  728=  729=  730=  731=  732=  733=  734=  735=  736=  737=  738=  739=  740=
                                             741=  742=  743=  744=  745=  746=  747=  748=  749=  750=  751=  752=  753=  754=
                                             755=  756=  760=  761=  762=  763=  764=  765=  766=  767=  768=  769=  770=  771=
                                             775=  776=  777=  778=  779=  780=  781=  782=  783=  784=  785=  786=  787=  788=
                                             789=  790=  791=  792=  793=  794=  795=  796=  797=  798=  799=  800=  801=  802=
                                             803=  804=  805=  806=  807=  808=  809=  810=  811=  812=  816=  817=  818=  819=
                                             820=  821=  822=  823=  824=  825=  826=  827=  828=  829=  830=  831=  835=  836=
                                             837=  838=  839=  840=  841=  842=  843=  844=  845=  849=  850=  851=  852=  853=
                                             854=  855=  856=  857=  858=  859=  860=  864=  865=  866=  867=  868=  869=  870=
                                             871=  872=  873=  874=  875=  876=  877=  878=  879=  880=  881=  882=  883=  884=
                                             885=  886=  887=  888=  889=  890=  891=  895=  896=  897=  898=  899=  900=  907u
Status   INTEGER    VARIABLE                 290r  293s  470u  607u
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   29
SUBROUTINE DRAWLD     Compiling Options:/N0/N7/NC/ND/E/H/NU/X

Label Cross-Reference Listing - Reference types:
 a-ASSIGN; d-DO Label; @-FORMAT Statement; f-FORMAT Usage; g-GOTO; i-IF; s-Specified; r-Argument
_______________________________________________________________________________________________________________________________Label        Line (I include file)<reference type - see above>

00100        298d  302s
00110        299d  301s
00200        414d  422s
00300        906d  908s
Lahey Personal FORTRAN 77, Version 2.00    01/01/80  04:14:40                                                      Page   30
SUBROUTINE CLRSCR     Compiling Options:/N0/N7/NC/ND/E/H/NU/X
Source file Listing

      913        
      914        
      915  C     ****************************************************************
      916  C     *                    SUBROUTINE CLRSCR                         *
      917  C     *                  Clear screen display                        *
      918  C     ****************************************************************
      919        
      920        SUBROUTINE CLRSCR
      921        
      922        IMPLICIT NONE
      923        INTEGER I
      924        
      925  C     Print blank lines to clear screen
      926        
      927        DO 100 I = 1, 6
      928           WRITE(*,*)
      929  100   CONTINUE
      930        
      931        RETURN
      932       
      933        END

Storage Area Definitions
_______________________________________________________________________________________________________________________________Number  Name or Description     Segment Name          Hex Length

    0   Local Stack                                      017E


Symbol Cross-Reference Listing - Reference types:
 =-Assigned; /-DATA; d-DO Index; f-FORMAT Usage; i-Input; o-Output; r-Argument; s-Specified; u-Used
_______________________________________________________________________________________________________________________________Name     Type       Class      Area Offset  Line (I include file)<reference type - see above>

Clrscr              SUBROUTINE               920s
I        INTEGER    VARIABLE    0  BP+FFF4   923s  927d


Label Cross-Reference Listing - Reference types:
 a-ASSIGN; d-DO Label; @-FORMAT Statement; f-FORMAT Usage; g-GOTO; i-IF; s-Specified; r-Argument
_______________________________________________________________________________________________________________________________Label        Line (I include file)<reference type - see above>

00100        927d  929s
